<div class="grad-ocupare-container">
  <div class="header">
    <button class="back-button" (click)="goBack()">← Inapoi</button>
  </div>
  
  <h1>Analiză Grad Ocupare Specializări 2024</h1>
  
  <div class="input-section">
    <label for="userPosition">Introduceți poziția (ex: 500):</label>
    <input 
      type="number" 
      id="userPosition" 
      [(ngModel)]="userPosition" 
      placeholder="500"
      min="1">
    <button (click)="analyzeOccupancy()" [disabled]="!userPosition || isLoading">
      Analizează
    </button>
  </div>

  <div *ngIf="analyzed && userGrade" class="user-info">
    <p><strong>Poziția:</strong> {{userPosition}} (Media corespunzătoare: {{userGrade | number:'1.2-2'}})</p>
  </div>

  <div *ngIf="isLoading" class="loading">
    Se încarcă datele...
  </div>

  <div *ngIf="analyzed && !isLoading" class="results">
    
    <div class="section">
      <h2>Specializări complet ocupate</h2>
      <table *ngIf="completOcupate.length > 0; else noDataComplete">
        <thead>
          <tr>
            <th>Liceu + Specializare</th>
            <th>Poziții ocupate</th>
            <th>Locuri ocupate</th>
            <th>Locuri libere</th>
            <th>% Ocupare</th>
            <th>Ultima medie</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of completOcupate">
            <td class="school-specialization-cell">
              <div class="school-name">{{item.school}}</div>
              <div class="specialization-name">{{item.specialization}}</div>
              <div class="language-name">{{item.language}}</div>
            </td>
            <td>{{item.indexRange}}</td>
            <td>{{item.occupiedSlots}}</td>
            <td>{{item.freeSlots}}</td>
            <td>{{item.occupancyRate | number:'1.2-2'}}%</td>
            <td>{{item.lastAdmittedGrade | number:'1.2-2'}}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #noDataComplete>
        <p>Nu există specializări complet ocupate pentru această poziție.</p>
      </ng-template>
    </div>

    <div class="section">
      <h2>Specializări parțial ocupate</h2>
      <table *ngIf="partialOcupate.length > 0; else noDataPartial">
        <thead>
          <tr>
            <th>Liceu + Specializare</th>
            <th>Poziții ocupate</th>
            <th>Locuri ocupate</th>
            <th>Locuri libere</th>
            <th>% Ocupare</th>
            <th>Ultima medie</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of partialOcupate">
            <td class="school-specialization-cell">
              <div class="school-name">{{item.school}}</div>
              <div class="specialization-name">{{item.specialization}}</div>
              <div class="language-name">{{item.language}}</div>
            </td>
            <td>{{item.indexRange}}</td>
            <td>{{item.occupiedSlots}}</td>
            <td>{{item.freeSlots}}</td>
            <td>{{item.occupancyRate | number:'1.2-2'}}%</td>
            <td>{{item.lastAdmittedGrade | number:'1.2-2'}}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #noDataPartial>
        <p>Nu există specializări parțial ocupate pentru această poziție.</p>
      </ng-template>
    </div>

    <div class="section">
      <h2>Specializări cu locuri disponibile</h2>
      <table *ngIf="neocupate.length > 0; else noDataEmpty">
        <thead>
          <tr>
            <th>Liceu + Specializare</th>
            <th>Poziții ocupate</th>
            <th>Locuri ocupate</th>
            <th>Locuri libere</th>
            <th>% Ocupare</th>
            <th>Ultima medie</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of neocupate">
            <td class="school-specialization-cell">
              <div class="school-name">{{item.school}}</div>
              <div class="specialization-name">{{item.specialization}}</div>
              <div class="language-name">{{item.language}}</div>
            </td>
            <td>{{item.indexRange}}</td>
            <td>{{item.occupiedSlots}}</td>
            <td>{{item.freeSlots}}</td>
            <td>{{item.occupancyRate | number:'1.2-2'}}%</td>
            <td>{{item.lastAdmittedGrade | number:'1.2-2'}}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #noDataEmpty>
        <p>Nu există specializări cu locuri disponibile pentru această poziție.</p>
      </ng-template>
    </div>

  </div>
</div>
