<div class="grad-ocupare-container">
  <div class="header">
    <button class="back-button" (click)="goBack()">‚Üê Inapoi</button>
  </div>
  
  <h1>Analiza Grad Ocupare Specializari 2024</h1>
  
  <div class="input-section">
    <label for="userPosition">Introduceti pozitia (ex: 500):</label>
    <input 
      type="number" 
      id="userPosition" 
      [(ngModel)]="userPosition" 
      placeholder="500"
      min="1">
    <button (click)="analyzeOccupancy()" [disabled]="!userPosition || isLoading">
      Analizeaza
    </button>
  </div>

  <div *ngIf="analyzed && userGrade" class="user-info">
    <p><strong>Pozitia:</strong> {{userPosition}} (Media corespunzatoare: {{userGrade | number:'1.2-2'}})</p>
  </div>

  <div *ngIf="isLoading" class="loading">
    Se incarca datele...
  </div>

  <div *ngIf="analyzed && !isLoading" class="results">
    
    <div class="section">
      <h2>Specializari complet ocupate</h2>
      <table *ngIf="completOcupate.length > 0; else noDataComplete">
        <thead>
          <tr>
            <th>Liceu + Specializare</th>
            <th>Pozitii ocupate</th>
            <th>Locuri ocupate</th>
            <th>Locuri libere</th>
            <th>% Ocupare</th>
            <th>Ultima medie</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of completOcupate">
            <td class="school-specialization-cell">
              <div class="school-name">{{item.school}}</div>
              <div class="specialization-name">{{item.specialization}}</div>
              <div class="language-name">{{item.language}}</div>
            </td>
            <td>{{item.indexRange}}</td>
            <td>{{item.occupiedSlots}}</td>
            <td>{{item.freeSlots}}</td>
            <td>{{item.occupancyRate | number:'1.2-2'}}%</td>
            <td>{{item.lastAdmittedGrade | number:'1.2-2'}}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #noDataComplete>
        <p>Nu exista specializari complet ocupate pentru aceasta pozitie.</p>
      </ng-template>
    </div>

    <div class="section">
      <h2>Specializari partial ocupate</h2>
      <table *ngIf="partialOcupate.length > 0; else noDataPartial">
        <thead>
          <tr>
            <th>Liceu + Specializare</th>
            <th>Pozitii ocupate</th>
            <th>Locuri ocupate</th>
            <th>Locuri libere</th>
            <th>% Ocupare</th>
            <th>Ultima medie</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of partialOcupate">
            <td class="school-specialization-cell">
              <div class="school-name">{{item.school}}</div>
              <div class="specialization-name">{{item.specialization}}</div>
              <div class="language-name">{{item.language}}</div>
            </td>
            <td>{{item.indexRange}}</td>
            <td>{{item.occupiedSlots}}</td>
            <td>{{item.freeSlots}}</td>
            <td>{{item.occupancyRate | number:'1.2-2'}}%</td>
            <td>{{item.lastAdmittedGrade | number:'1.2-2'}}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #noDataPartial>
        <p>Nu exista specializari partial ocupate pentru aceasta pozitie.</p>
      </ng-template>
    </div>

    <div class="section">
      <h2>Specializari cu locuri disponibile</h2>
      <table *ngIf="neocupate.length > 0; else noDataEmpty">
        <thead>
          <tr>
            <th>Liceu + Specializare</th>
            <th>Pozitii ocupate</th>
            <th>Locuri ocupate</th>
            <th>Locuri libere</th>
            <th>% Ocupare</th>
            <th>Ultima medie</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of neocupate">
            <td class="school-specialization-cell">
              <div class="school-name">{{item.school}}</div>
              <div class="specialization-name">{{item.specialization}}</div>
              <div class="language-name">{{item.language}}</div>
            </td>
            <td>{{item.indexRange}}</td>
            <td>{{item.occupiedSlots}}</td>
            <td>{{item.freeSlots}}</td>
            <td>{{item.occupancyRate | number:'1.2-2'}}%</td>
            <td>{{item.lastAdmittedGrade | number:'1.2-2'}}</td>
          </tr>
        </tbody>
      </table>
      <ng-template #noDataEmpty>
        <p>Nu exista specializari cu locuri disponibile pentru aceasta pozitie.</p>
      </ng-template>
    </div>

  </div>
</div>
